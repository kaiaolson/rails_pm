<h1><%= @project.title%></h1>
<p><%= @project.description %></p>
<p><%= @project.due_date %></p>

<%= link_to "Edit", edit_project_path(@project) %> |
<%= link_to "Delete", project_path(@project), method: :delete, data: {confirm: "Are you sure you want to delete this project?"} %>

<hr>

<%= content_tag(:div, class: "col-sm-6") do %>
<h2>Tasks</h2>

<%#= content_tag(:table, class: "table table-striped table-bordered") do %>
  <%#= content_tag(:tbody) do %>
    <%#= content_tag(:td, "Task") %>
    <%#= content_tag(:td, "Due") %>
    <%#= content_tag(:td, "Created At" ) %>
    <%#= content_tag(:td, "Updated At" ) %>
    <%#= content_tag(:td, "Actions", style: "width:20%;") %>
    <%# @project.tasks.where(status: "Not Done").order("due_date DESC").each do |task|%>
      <%#= content_tag(:tr) do %>
        <%#= content_tag(:td, task.title ) %>
        <%#= content_tag(:td, task.due_date.strftime("%B %d, %Y") ) %>
        <%#= content_tag(:td, task.created_at.strftime("%B %d, %Y") ) %>
        <%#= content_tag(:td, task.updated_at.strftime("%B %d, %Y") ) %>
        <%#= content_tag(:td) do %>
          <%#= link_to "Delete", [@project, task],
                              method: :delete,
                              style: "text-align: right;",
                              data: {confirm: "Are you sure?"}%>
          <%#= link_to task.status, project_task_path(@project, task, :flip => task.id) %>
        <%# end %>
      <%# end %>
    <%# end %>
  <%# end %>
<%# end %>

<h3>To Do</h3>
<%= table_for @project.tasks.where(status: "Not Done").order("due_date DESC"), :html => {:class => "table table-striped table-bordered"} do -%>
  <% column :title %>
  <% column :due_date, :time_format => "%B %d, %Y" %>
  <% column :created_at, :time_format => "%B %d, %Y" %>
  <% column :updated_at, :time_format => "%B %d, %Y" %>
  <% column :title => "Actions" do |task| %>
    <% link_to("Delete", project_task_path(task.project_id, task.id), method: :delete, data: {confirm: "Are you sure?"})%>
  <% end %>
  <% column :title => "Status" do |task| %>
    <% link_to(task.status, project_task_path(task.project_id, task.id, :flip => task.id))  %>
  <% end %>
<% end %>

<h3>Completed</h3>
<%= table_for @project.tasks.where(status: "Done").order("due_date DESC"), :html => {:class => "table table-striped table-bordered"} do -%>
  <% column :title %>
  <% column :due_date, :time_format => "%B %d, %Y" %>
  <% column :created_at, :time_format => "%B %d, %Y" %>
  <% column :updated_at, :time_format => "%B %d, %Y" %>
  <% column :title => "Actions" do |task| %>
    <% link_to("Delete", project_task_path(task.project_id, task.id), method: :delete, data: {confirm: "Are you sure?"})%>
  <% end %>
  <% column :title => "Status" do |task| %>
    <% link_to(task.status, project_task_path(task.project_id, task.id, :flip => task.id))  %>
  <% end %>
<% end %>

<%= @task.errors.full_messages.join(", ") %>

<%= form_for [@project, @task], :html => {class:"form-inline"} do |f| %>
  <%= content_tag(:div, class: "form-group") do %>
    <%= f.label :title %>
    <%= f.text_field :title, class: "form-control" %>
  <% end %>
  <%= content_tag(:div, class: "form-group") do %>
    <%= f.label :due_date %>
    <%= f.text_field :due_date, class: "form-control" %>
  <% end %>
  <%= f.submit class: "btn btn-primary" %>
<% end %>

<% end %>

<%= content_tag(:div, class: "col-sm-6") do %>
<h2>&nbsp;</h2>
<h3>Discussions</h3>

<%= table_for @project.discussions.order("updated_at DESC"), :html => {:class => "table table-striped table-bordered"} do -%>
  <% column :title %>
  <% column :description %>
  <% column :created_at, :time_format => "%B %d, %Y" %>
  <% column :updated_at, :time_format => "%B %d, %Y" %>
  <% column :title => "Actions" do |disc| %>
    <% link_to("View", project_discussion_path(disc.project_id, disc.id))%>
  <% end %>
<% end %>

<%= @discussion.errors.full_messages.join(", ") %>

<%= form_for [@project, @discussion], :html => {class:"form-inline"} do |f| %>
  <%= content_tag(:div, class: "form-group") do %>
    <%= f.label :title %>
    <%= f.text_field :title, class: "form-control" %>
  <% end %>
  <%= content_tag(:div, class: "form-group") do %>
    <%= f.label :description %>
    <%= f.text_field :description, class: "form-control" %>
  <% end %>
  <%= f.submit class: "btn btn-primary" %>
<% end %>

<% end %>
